<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Argentum Games</title>
<link rel="icon" href="./logo.png">
<style>
  body { font-family: sans-serif; margin: 0; padding: 0; }
  .tab { display: none; padding: 20px; }
  .active { display: block; }
  input, select, button { margin: 5px 0; padding: 5px; }
  .recuadro { border: 1px solid #ccc; padding: 10px; margin: 10px 0; }
  .peque { display: inline-block; width: 150px; height: 150px; border:1px solid #aaa; margin:5px; text-align:center; vertical-align:top; }
</style>
<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
<script>

const firebaseConfig = {
  apiKey: "AIzaSyCYXAhphpsLpjhAY-am0TxXmh7JwnTztHE",
  authDomain: "argentum-gaames.firebaseapp.com",
  projectId: "argentum-gaames",
  storageBucket: "argentum-gaames.firebasestorage.app",
  messagingSenderId: "365917889897",
  appId: "1:365917889897:web:82e8fca98dcdc88cfc09f8"
};
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();
</script>
</head>
<body>

<h1>Argentum Games</h1>
<p>Aqui vas a encontrar juegos clasicos de Argentina.</p>

<!-- LOGIN -->
<div id="login" class="tab active">
  <p>Introduci tu nombre de usuario</p>
  <input placeholder="Usuario" id="usuario-login">
  <p>Introduci tu clave</p>
  <input placeholder="Clave" id="clave-login" type="password">
  <br>
  <button onclick="login()">Iniciar Sesion</button>
  <button onclick="cambiarTab('register')">Crear una Cuenta</button>
</div>

<!-- REGISTER -->
<div id="register" class="tab">
  <p>Introduci tu nombre de usuario</p>
  <input placeholder="Usuario" id="usuario-reg">
  <p>Introduci tu clave</p>
  <input placeholder="Clave" id="clave-reg" type="password">
  <br>
  <button onclick="register()">Registrar</button>
  <button onclick="cambiarTab('login')">Ya tengo una Cuenta</button>
</div>

<!-- INICIO -->
<div id="inicio" class="tab">
  <div class="recuadro"><h3 id="usuario-nombre"></h3></div>

  <div class="recuadro">
    <h2>Amistades</h2>
    <div id="amistades"></div>
  </div>

  <div class="recuadro">
    <h2>Crear una Partida</h2>
    <div class="peque">
      <img src="" width="100" height="100"><br>
      <h3>TA-TE-TI</h3>
      <button onclick="cambiarTab('crear-tateti')">▶️</button>
    </div>
    <div class="peque">
      <img src="" width="100" height="100"><br>
      <h3>Tutti Frutti</h3>
      <button onclick="cambiarTab('crear-tutti-frutti')">▶️</button>
    </div>
  </div>

  <div class="recuadro">
    <h2>Unirme a una Sala</h2>
    <p>Introduci el codigo</p>
    <input placeholder="XXX-XXX" id="codigo-partida">
    <button onclick="entrar()">Entrar</button>
  </div>
</div>

<!-- CREAR TATETI -->
<div id="crear-tateti" class="tab">
  <h1>Crear Una Sala</h1>
  <p>Indique la cantidad de usuarios que van a poder jugar</p>
  <select id="select-tateti">
    <option disabled selected>Seleccione una cantidad</option>
    <option value="2">2 jugadores</option>
  </select>
  <button onclick="crearSala1()">Crear Sala</button>
</div>

<!-- CREAR TUTTI FRUTTI -->
<div id="crear-tutti-frutti" class="tab">
  <h1>Crear Una Sala</h1>
  <p>Indique la cantidad de usuarios que van a poder jugar</p>
  <select id="select-tutti">
    <option disabled selected>Seleccione una cantidad</option>
    <option value="2">2 jugadores</option>
    <option value="4">4 jugadores</option>
  </select>
  <p>Marca las categorias con las que se jugaran:</p>
  <div>
    <label><input type="checkbox" checked disabled> Cat. Obligatoria</label><br>
    <label><input type="checkbox" id="cat-animales"> Cat. Animales</label><br>
    <label><input type="checkbox" id="cat-ubicaciones"> Cat. Ubicaciones</label><br>
    <label><input type="checkbox" id="cat-entretenimiento"> Cat. Entretenimiento</label><br>
    <label><input type="checkbox" id="cat-escuela"> Cat. Escuela</label><br>
    <label><input type="checkbox" id="cat-naturaleza"> Cat. Naturaleza</label><br>
    <label><input type="checkbox" id="cat-tecnologia"> Cat. Tecnologia</label><br>
    <label><input type="checkbox" id="cat-random"> Cat. Ramdom</label><br>
  </div>
  <button onclick="crearSala2()">Crear Sala</button>
</div>

<script>
// Cambio de pestañas
function cambiarTab(tab){
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  document.getElementById(tab).classList.add('active');
}

// LOGIN
function login(){
  const usuario = document.getElementById('usuario-login').value;
  const clave = document.getElementById('clave-login').value;
  db.ref('cuentas').orderByChild('usuario').equalTo(usuario).once('value', snap => {
    if(snap.exists()){
      let valid = false;
      snap.forEach(s => {
        if(s.val().clave === clave){ valid = true; }
      });
      if(valid){
        document.getElementById('usuario-nombre').innerText = usuario;
        cambiarTab('inicio');
      } else alert('Clave incorrecta');
    } else alert('Usuario no existe');
  });
}

// REGISTER
function register(){
  const usuario = document.getElementById('usuario-reg').value;
  const clave = document.getElementById('clave-reg').value;
  const newUser = { usuario, clave };
  db.ref('cuentas').push(newUser, err=>{
    if(!err) location.reload();
  });
}

// CREAR SALA TATETI
function generarCodigo(){ 
  let letras = 'abcdefghijklmnopqrstuvwxyz';
  let code = '';
  for(let i=0;i<3;i++) code+=letras[Math.floor(Math.random()*letras.length)];
  code += '-';
  for(let i=0;i<3;i++) code+=letras[Math.floor(Math.random()*letras.length)];
  return code;
}

function crearSala1(){
  const max = document.getElementById('select-tateti').value;
  const codigo = generarCodigo();
  const formato = { usersMAX: max, modo: 'tateti' };
  db.ref('partidas/'+codigo).set(formato, err=>{
    if(!err) window.open(`https://abelcraftok.github.io/ARGENTUM/partidas.html?codigo=${codigo}`, '_blank');
  });
}

// CREAR SALA TUTTI FRUTTI
function crearSala2(){
  const max = document.getElementById('select-tutti').value;
  const categorias = [];
  if(document.getElementById('cat-animales').checked) categorias.push('Animales');
  if(document.getElementById('cat-ubicaciones').checked) categorias.push('Ubicaciones');
  if(document.getElementById('cat-entretenimiento').checked) categorias.push('Entretenimiento');
  if(document.getElementById('cat-escuela').checked) categorias.push('Escuela');
  if(document.getElementById('cat-naturaleza').checked) categorias.push('Naturaleza');
  if(document.getElementById('cat-tecnologia').checked) categorias.push('Tecnologia');
  if(document.getElementById('cat-random').checked) categorias.push('Ramdom');
  const codigo = generarCodigo();
  const formato = { usersMAX: max, modo: 'Tutti Frutti', categorias };
  db.ref('partidas/'+codigo).set(formato, err=>{
    if(!err) window.open(`https://abelcraftok.github.io/ARGENTUM/partidas.html?codigo=${codigo}`, '_blank');
  });
}

// ENTRAR A SALA
function entrar(){
  const codigo = document.getElementById('codigo-partida').value;
  window.open(`https://abelcraftok.github.io/ARGENTUM/partidas.html?codigo=${codigo}`, '_blank');
}
</script>
</body>
</html>
