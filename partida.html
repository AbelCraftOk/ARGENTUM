<!-- index.html -->
<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Argentum Games</title>
<link rel="icon" href="./logo.png">
<style>
body {font-family: Arial, sans-serif; margin:0; padding:0;}
.hidden {display:none;}
input, select, button {margin:5px; padding:5px;}
.recuadro {border:1px solid #000; padding:10px; margin:10px;}
.recuadro-peq {border:1px solid #666; padding:5px; margin:5px; display:inline-block;}
#tabla-partida-tutti-frutti table, #tabla-partida-tutti-frutti th, #tabla-partida-tutti-frutti td {border:1px solid black; border-collapse: collapse; padding:2px; font-size:14px;}
</style>
</head>
<body>

<!-- Login -->
<div id="login-tab">
  <p>Introduci tu nombre de usuario</p>
  <input placeholder="Usuario" id="usuario-login">
  <p>Introduci tu clave</p>
  <input placeholder="Clave" id="clave-login" type="password">
  <br>
  <button onclick="login()">Iniciar Sesion</button>
  <button onclick="changeTab('register')">Crear una Cuenta</button>
</div>

<!-- Register -->
<div id="register-tab" class="hidden">
  <p>Introduci tu nombre de usuario</p>
  <input placeholder="Usuario" id="usuario-register">
  <p>Introduci tu clave</p>
  <input placeholder="Clave" id="clave-register" type="password">
  <br>
  <button onclick="register()">Crear Cuenta</button>
  <button onclick="changeTab('login')">Ya tengo una Cuenta</button>
</div>

<!-- Inicio -->
<div id="inicio-tab" class="hidden">
  <div class="recuadro">
    <h3 id="nombre-usuario">Usuario</h3>
  </div>
  <div class="recuadro">
    <h2>Amistades</h2>
    <div class="recuadro-peq">
      <img src="" width="50" height="50">
      <h3>Agregar Amistades</h3>
    </div>
    <div id="amistades"></div>
  </div>
  <div class="recuadro">
    <h2>Crear una Partida</h2>
    <div class="recuadro-peq">
      <img src="" width="50" height="50">
      <h3>TA-TE-TI</h3>
      <button onclick="changeTab('crear-tateti')">▶️</button>
    </div>
    <div class="recuadro-peq">
      <img src="" width="50" height="50">
      <h3>Tutti Frutti</h3>
      <button onclick="changeTab('crear-tutti-frutti')">▶️</button>
    </div>
  </div>
  <div class="recuadro">
    <h2>Unirme a una Sala</h2>
    <p>Introduci el codigo</p>
    <input placeholder="XXX-XXX" id="codigo-partida">
    <button onclick="entrar()">Entrar</button>
  </div>
</div>

<!-- Crear Tateti -->
<div id="crear-tateti-tab" class="hidden">
  <h1>Crear Una Sala</h1>
  <p>Indique la cantidad de usaurios que van a poder jugar</p>
  <select id="select-tateti">
    <option disabled selected>Seleccione una cantidad</option>
    <option value="2">2 jugadores</option>
  </select>
  <br>
  <button onclick="crearSalaTateti()">Crear Sala</button>
</div>

<!-- Crear Tutti Frutti -->
<div id="crear-tutti-frutti-tab" class="hidden">
  <h1>Crear Una Sala</h1>
  <p>Indique la cantidad de usaurios que van a poder jugar</p>
  <select id="select-tutti">
    <option disabled selected>Seleccione una cantidad</option>
    <option value="2">2 jugadores</option>
    <option value="4">4 jugadores</option>
  </select>
  <p>Marca las categorias con las que se jugaran:</p>
  <div>
    <label><input type="checkbox" checked disabled> Cat. Obligatoria</label><br>
    <label><input type="checkbox" id="animales"> Cat. Animales</label><br>
    <label><input type="checkbox" id="ubicaciones"> Cat. Ubicaciones</label><br>
    <label><input type="checkbox" id="entretenimiento"> Cat. Entretenimiento</label><br>
    <label><input type="checkbox" id="escuela"> Cat. Escuela</label><br>
    <label><input type="checkbox" id="naturaleza"> Cat. Naturaleza</label><br>
    <label><input type="checkbox" id="tecnologia"> Cat. Tecnologia</label><br>
    <label><input type="checkbox" id="random"> Cat. Ramdom</label><br>
  </div>
  <button onclick="crearSalaTutti()">Crear Sala</button>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script>
const firebaseConfig = {
  apiKey: "AIzaSyCYXAhphpsLpjhAY-am0TxXmh7JwnTztHE",
  authDomain: "argentum-gaames.firebaseapp.com",
  projectId: "argentum-gaames",
  storageBucket: "argentum-gaames.firebasestorage.app",
  messagingSenderId: "365917889897",
  appId: "1:365917889897:web:82e8fca98dcdc88cfc09f8"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

let currentUser = "";

function changeTab(tab){
  document.querySelectorAll('div[id$="-tab"]').forEach(t => t.classList.add('hidden'));
  document.getElementById(tab + '-tab').classList.remove('hidden');
}

function login(){
  const user = document.getElementById('usuario-login').value;
  const pass = document.getElementById('clave-login').value;
  db.ref('cuentas').orderByChild('usuario').equalTo(user).once('value', snap => {
    let found = false;
    snap.forEach(child => {
      if(child.val().clave === pass){
        found = true;
        currentUser = user;
        document.getElementById('nombre-usuario').innerText = user;
        changeTab('inicio');
      }
    });
    if(!found) alert('Usuario o clave incorrectos');
  });
}

function register(){
  const user = document.getElementById('usuario-register').value;
  const pass = document.getElementById('clave-register').value;
  db.ref('cuentas').push({usuario: user, clave: pass});
  location.reload();
}

function generarCodigo(){
  const chars = 'abcdefghijklmnopqrstuvwxyz';
  let code = '';
  for(let i=0;i<3;i++) code+=chars[Math.floor(Math.random()*chars.length)];
  code+='-';
  for(let i=0;i<3;i++) code+=chars[Math.floor(Math.random()*chars.length)];
  return code;
}

function crearSalaTateti(){
  const usersMAX = document.getElementById('select-tateti').value;
  const codigo = generarCodigo();
  const data = {usersMAX, modo:'tateti'};
  db.ref('partidas/'+codigo).set(data);
  window.open('https://abelcraftok.github.io/ARGENTUM/partidas.html?codigo='+codigo);
}

function crearSalaTutti(){
  const usersMAX = document.getElementById('select-tutti').value;
  let categorias = ['Obligatoria'];
  if(document.getElementById('animales').checked) categorias.push('Animales');
  if(document.getElementById('ubicaciones').checked) categorias.push('Ubicaciones');
  if(document.getElementById('entretenimiento').checked) categorias.push('Entretenimiento');
  if(document.getElementById('escuela').checked) categorias.push('Escuela');
  if(document.getElementById('naturaleza').checked) categorias.push('Naturaleza');
  if(document.getElementById('tecnologia').checked) categorias.push('Tecnologia');
  if(document.getElementById('random').checked) categorias.push('Random');
  const codigo = generarCodigo();
  const data = {usersMAX, categorias, modo:'Tutti Frutti'};
  db.ref('partidas/'+codigo).set(data);
  window.open('https://abelcraftok.github.io/ARGENTUM/partidas.html?codigo='+codigo);
}

function entrar(){
  const codigo = document.getElementById('codigo-partida').value;
  window.open('https://abelcraftok.github.io/ARGENTUM/partidas.html?codigo='+codigo);
}
</script>
</body>
</html>
